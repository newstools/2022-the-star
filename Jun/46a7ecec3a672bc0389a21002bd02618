Rapper Kendrick Lamar has ended his Glastonbury headline set with a powerful protest at the roll-back of abortion rights in the US. With blood pouring down his face from a crown of thorns, the star proclaimed: "Godspeed for women's rights. They judge you, they judge Christ." He repeated the phrase over and over with increasing intensity, eventually breaking off mid-sentence and throwing his microphone to the ground before walking off stage. It was a forceful end to a theatrical performance that was unlike anything the festival has ever witnessed. Throughout the show, Lamar, who won a Pulitzer Prize for his 2017 album Damn, addressed themes of guilt, greed, loyalty, power, ambition and prejudice, shouldering the audience's problems by examining his own. He emerged flanked by 20 dancers to perform United In Grief - a song that looks back over his 19-year career and the mental health problems he has addressed over multiple albums. As stood still behind a mic stand, they lined up behind him, each representing a different aspect in the evolution of his personality. As they scattered, he began an almost-chronological journey through his catalogue. Highlights included Alright, his soulful protest against injustice and police brutality; Humble, a scathing rant against toxic masculinity; and Swimming Pools (Drank), which discusses his grandfather's alcoholism. At every turn, dancers reflected the star's internal and external struggles. In the second verse of the recent single N95, which tackles wealth disparity, all the stage lights went off and the dancers turned flashlights onto Lamar, highlighting his own unease with fame and fortune. The show was heavy on concept without alienating the audience. And unlike many live rap shows, Lamar's vocals were controlled and nuanced, allowing his lyrics to cut through. The climax came on Savior, a song that examines Covid conspiracies, the Black Lives Matter movement, political correctness and his own personal flaws - which he juxtaposes with his faith in Christ. Introducing the song, he explained the message was that "imperfection is beautiful", and that in our rush to judgment, we often lose sight of others' humanity. The closing lyrics, "Godspeed women's rights", were added for Sunday night's performance; which came two days after the US Supreme Court overturned the constitutional right to abortion. In some ways, Lamar's thorny and introspective songs made him a brave choice to headline Glastonbury's main stage. But in the event he rose to the challenge, delivering a visceral and compelling set that will be talked about for weeks. British rapper AJ Tracey, who gave a thrilling Pyramid Stage performance of his own on Saturday, said Lamar was one of the most important artists of his generation. "He works very hard but he's also unwavering in his message," he told BBC News. "There's a meaning behind everything he does. He always stands up for black people, for impoverished people, people who are unfairly treated - and that means a lot to people. "When you're already a good rapper, it's easy to be on autopilot," he continued, "but when you stand for something and you push a message, that's what makes people love you." Festivalgoers who craved something more euphoric at the end of the long weekend had the option of going to see pop royalty Pet Shop Boys play a joyous greatest hits set on The Other Stage. The metronomic house grooves of Its Alright and Vocal turned the field into a giant rave; while Go West ("a song of gay liberation that became a football anthem," as Neil Tennant billed it) even had the security team singing along. The band dedicated Being Boring to theÂ victims of the Oslo Pride shooting; and ended the night with a valedictory performance of their debut single West End Girls. Pop star Charli XCX also gave a full-throttle performance on the John Peel stage, that illuminated her ever-expanding catalogue of pop classics, from I Love It and Boom Clap, to more recent hits like Gone and New Shapes.